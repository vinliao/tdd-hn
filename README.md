## TODO
1. Think about how I can refactor this, it's really messy...